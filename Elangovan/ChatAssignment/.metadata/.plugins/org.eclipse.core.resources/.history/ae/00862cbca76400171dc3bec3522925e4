package com.assignment.chat.server.test;

import java.net.Socket;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Mockito;

import com.assignment.chat.server.Server;

public class ServerTest {
	
	  @Test public void testStart() {
		  Socket socket = Mockito.mock(Socket.class);
		  Server serverChat = new Server(1500);
		  serverChat.start();
	  }
	  
	  @Test public void testSend() {
		  
		    String text = "some configuration text";
		    String response = "200";
		    String encoding = "UTF-8";
		 
		    try {
		      Socket socket = mock(Socket.class);
		 
		      ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
		      when(socket.getOutputStream()).thenReturn(byteArrayOutputStream);
		 
		      InputStream inputStream = new ByteArrayInputStream(response.getBytes(encoding));
		      when(socket.getInputStream()).thenReturn(inputStream);
		 
		      TheSocket theSocket = new TheSocket(socket);
		 
		      assertEquals(theSocket.send(text), response); // message sent and got a response
		      assertEquals(text, byteArrayOutputStream.toString(encoding)); // msg sent = msg received
		 
		    } catch (IOException e) {
		      e.printStackTrace();
		    }
		  }
	

}
